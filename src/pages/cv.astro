---
import Layout from '../layouts/Layout.astro';
import Role from '../components/Role.astro';
import SummarySection from '../components/SummarySection.astro';
import SummarySectionList from '../components/SummarySectionList.astro';
import { getCollection, getEntry } from 'astro:content';

const roles = await getCollection('roles');
const skillsSection = await getEntry('summary-sections', 'skills');
const renderedRoles = await Promise.all(roles.map(async role => {
  const { Content } = await role.render();
  return { ...role, Content };
}));

renderedRoles.sort((a, b) => {
  const aBegin = new Date(a.data.begin).getTime();
  const bBegin = new Date(b.data.begin).getTime();
  return bBegin - aBegin;
});
---

<Layout title="CV's CV">
  <div class="cv-page">
    <div class="cv">
      <aside class="summary-bar">
        <div>
          <svg class="logo"xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 200 54"><path fill="#fff" d="M6.79 53.84.67 43.14 25.13.34h48.92l6.11 10.7H31.25L6.79 53.84ZM55.7 53.84H19.03l6.11-10.7H49.6l12.23-21.4h12.23l-18.34 32.1ZM121.19 24.07c-2.41 0-4.58-.5-6.52-1.51a11.78 11.78 0 0 1-4.57-4.25 11.34 11.34 0 0 1-1.67-6.08 11.4 11.4 0 0 1 6.24-10.33A13.61 13.61 0 0 1 121.2.33c2.2 0 4.1.33 5.68 1 1.62.66 3.01 1.72 4.18 3.18l-4.06 3.7a6.96 6.96 0 0 0-5.56-2.75 6.6 6.6 0 0 0-4.81 1.87 6.61 6.61 0 0 0-1.87 4.89c0 1.32.28 2.5.84 3.53.58 1.01 1.37 1.8 2.38 2.35 1.03.56 2.19.83 3.46.83 2.2 0 4.05-.91 5.56-2.74l4.06 3.7a10.42 10.42 0 0 1-4.18 3.18c-1.61.66-3.5 1-5.68 1ZM151.63 19.1h-10.7l-1.9 4.53h-6.09L143.2.78h6.2l10.3 22.85h-6.2l-1.88-4.53Zm-1.91-4.53L146.3 6.3l-3.46 8.27h6.88ZM162.8.78h6.28v22.85h-6.28V.78ZM186.56 24.07c-2.44 0-4.63-.5-6.6-1.51a11.8 11.8 0 0 1-4.57-4.25 11.34 11.34 0 0 1-1.66-6.08 11.41 11.41 0 0 1 6.24-10.33 13.93 13.93 0 0 1 6.6-1.56c2.43 0 4.62.52 6.55 1.55a11.35 11.35 0 0 1 6.28 10.34c0 2.25-.56 4.27-1.67 6.08a11.72 11.72 0 0 1-4.6 4.25 14 14 0 0 1-6.57 1.51Zm0-5.13a6.33 6.33 0 0 0 5.65-3.26c.55-1.03.83-2.18.83-3.45 0-1.3-.28-2.46-.83-3.46a6.33 6.33 0 0 0-5.64-3.3c-1.23 0-2.34.29-3.35.87a6.45 6.45 0 0 0-2.34 2.43c-.56 1-.84 2.16-.84 3.46 0 1.27.28 2.42.84 3.45.58 1.01 1.36 1.8 2.34 2.39 1.01.58 2.12.87 3.34.87ZM112.36 30.56l-9.94 22.85h-6.2L86.3 30.56h6.67l6.52 15.54 6.68-15.54h6.2ZM113.69 30.56h6.28V53.4h-6.28V30.56ZM135.6 53.85c-2.43 0-4.63-.5-6.59-1.51a11.78 11.78 0 0 1-4.57-4.26 11.34 11.34 0 0 1-1.67-6.08 11.4 11.4 0 0 1 6.24-10.33 13.93 13.93 0 0 1 6.6-1.55c2.44 0 4.62.51 6.56 1.55A11.34 11.34 0 0 1 148.45 42c0 2.25-.56 4.28-1.67 6.08a11.72 11.72 0 0 1-4.61 4.26c-1.94 1-4.12 1.5-6.56 1.5Zm0-5.13a6.33 6.33 0 0 0 5.65-3.26c.56-1.03.84-2.19.84-3.46 0-1.3-.28-2.45-.84-3.46a6.33 6.33 0 0 0-5.64-3.3c-1.22 0-2.33.3-3.34.88a6.45 6.45 0 0 0-2.34 2.42c-.56 1.01-.84 2.16-.84 3.46 0 1.27.28 2.43.84 3.46.58 1 1.36 1.8 2.34 2.38 1 .59 2.12.88 3.34.88ZM190.12 30.56h6.28V53.4h-6.28V30.56ZM155.2 35.44h-7.19v-4.88h40.47v4.88h-7.2v17.97H175V35.44H161.5v17.97h-6.28V35.44Z" style="mix-blend-mode:difference"/></svg>
          <h1 class="me">Caio Viotti</h1>
          <h2 class="title">UX Engineer</h2>
        </div>
        <SummarySection title={skillsSection.data.title}>
          {skillsSection.data.subsections?.map(subsection => (
            <SummarySectionList title={subsection.title} items={subsection.items} />
          ))}
        </SummarySection>
        <SummarySection title="Education">
          <div class="inner-summary -education">
            <h4>B.Sc.(Ed) Computer Science</h4>
            <p><b><a href="https://www.unb.br/">University of Brasilia</a></b></p>
            <p><b><a href="https://www.usnews.com/education/best-global-universities/universidade-de-brasilia-504217">Top 10 in Brazil</a></b></p>
            <p class="note">* 50% completed (not pursuing)</p>
          </div>
        </SummarySection>
        <SummarySection title="Personal">
          <ul class="inner-summary -personal">
            <li>
              Brazilian / EU citizen
              <svg class="icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 22 22"><path fill="#fff" d="M1.33 1.33H13.65A4 4 0 0 0 10.67 0H0v18.67h5.33v-1.33h-4v-16Z"/><path fill="#fff" fill-rule="evenodd" d="M5.33 3.12a4.67 4.67 0 0 0 0 8.43V10a3.33 3.33 0 0 1-1.26-2h1.26V6.67H4.07c.16-.81.62-1.52 1.26-2V3.12ZM4 7.32v.02-.01Z" clip-rule="evenodd"/><path fill="#fff" d="M5.33 16v-1.33H4V16h1.33Z"/><path fill="#fff" fill-rule="evenodd" d="M19 10.34a4.67 4.67 0 1 0-9.33 0 4.67 4.67 0 0 0 9.33 0Zm-1.4.66c-.2 1-.84 1.83-1.72 2.29.23-.64.38-1.43.44-2.29h1.28Zm-6.53 0c.2 1 .84 1.83 1.72 2.29a8.61 8.61 0 0 1-.43-2.29h-1.3Zm3.08 2.11a6.72 6.72 0 0 1-.46-2.1h1.29c-.06.86-.24 1.59-.46 2.1-.06.16-.13.28-.18.37-.06-.1-.13-.21-.2-.37Zm0-5.55c-.22.52-.4 1.25-.46 2.1h1.29a6.71 6.71 0 0 0-.46-2.1 2.75 2.75 0 0 0-.18-.37l-.2.37Zm3.45 2.1h-1.28a8.61 8.61 0 0 0-.44-2.28c.88.46 1.52 1.3 1.72 2.29Zm-5.24 0c.05-.85.2-1.64.43-2.28a3.34 3.34 0 0 0-1.72 2.29h1.29Zm-1.36.67v.01-.01Z" clip-rule="evenodd"/><path fill="#fff" d="M11 17.67h6.67V19H11v-1.33Z"/><path fill="#fff" fill-rule="evenodd" d="M7 3h10.67a4 4 0 0 1 4 4v10.67a4 4 0 0 1-4 4H7V3Zm1.33 1.33h9.34c1.47 0 2.67 1.2 2.67 2.67v10.67c0 1.47-1.2 2.67-2.67 2.67H8.33v-16Z" clip-rule="evenodd"/></svg>
            </li>
            <li>
              <a href="tel:5561992354318">+5561992354318</a>
              <svg class="icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 22 23"><g clip-path="url(#a)"><path fill="#fff" fill-rule="evenodd" d="m12.833 14.168 2.83-2.829 5.186 5.187-2.829 2.83a6.67 6.67 0 0 1-9.43 0l-5.66-5.66a6.67 6.67 0 0 1 0-9.43l2.83-2.83 5.187 5.188-2.83 2.829c-.52.52-.52 1.365 0 1.886l2.83 2.83c.52.52 1.365.52 1.886 0Zm-6.07-5.127a2.668 2.668 0 0 0 .412 3.241l2.829 2.83a2.668 2.668 0 0 0 3.241.411l3.331 3.332a5.336 5.336 0 0 1-7.044-.443l-5.658-5.658A5.336 5.336 0 0 1 3.43 5.71l3.332 3.33Zm.883-1.003 1.415-1.414L5.76 3.323 4.345 4.737l3.301 3.301Zm9.903 9.903 1.414-1.415-3.3-3.3-1.415 1.414 3.3 3.3Z" clip-rule="evenodd"/></g><defs><clipPath id="a"><path fill="#fff" d="M.06.958H21.4v21.34H.06z"/></clipPath></defs></svg>
            </li>
            <li>
              <a href="mailto:caio@viotti.me">caio@viotti.me</a>
              <svg class="icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 22 22"><path fill="#fff" fill-rule="evenodd" d="M10.73 15.915 7.396 12.58 2.337 17.64h16.786l-5.058-5.059-3.335 3.335Zm4.278-4.278 5.059 5.059V6.579l-5.06 5.058Zm6.392 7.336H.06V4.302H21.4v14.67ZM19.123 5.635H2.337l8.393 8.393 8.393-8.393ZM1.394 6.58l5.059 5.058-5.059 5.059V6.579Z" clip-rule="evenodd"/></svg>
            </li>
            <li>
              <a href='http://linkedin.com/in/caioviotti'>linkedin.com/in/caioviotti</a>
              <svg class="icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 22 22"><g fill="#fff" fill-rule="evenodd" clip-path="url(#a)" clip-rule="evenodd"><path d="M5.395 2.978a2.667 2.667 0 1 1-5.334 0 2.667 2.667 0 0 1 5.334 0Zm-1.333 0a1.334 1.334 0 1 1-2.668 0 1.334 1.334 0 0 1 2.668 0ZM13.398 14.32v7.33H8.063V6.98h5.335v.558c.924-.502 2.146-.97 3.37-.87 2.025.164 3.267 1.33 3.923 2.775.613 1.35.728 2.942.71 4.226a236.533 236.533 0 0 0-.003 6.481l.002.147.02 1.354h-5.355v-7.307a3.274 3.274 0 0 0-.039-.356 3.976 3.976 0 0 0-.228-.866c-.243-.6-.542-.857-1.038-.857-.369 0-.57.106-.703.217-.157.132-.3.342-.417.635a3.886 3.886 0 0 0-.242 1.196v.008Zm-1.334-4.053a.362.362 0 0 1 .05-.093c.157-.226.64-.66 1.284-1.084.919-.603 2.165-1.183 3.262-1.094 2.933.237 3.443 3.206 3.407 5.652a246.61 246.61 0 0 0 0 6.668h-2.668v-6.001s-.093-3.385-2.64-3.385c-1.003 0-1.633.469-2.028 1.058a3.214 3.214 0 0 0-.242.43c-.425.909-.425 1.896-.425 1.896v6.002H9.397V8.313h2.667v1.954ZM.06 6.979v14.67h5.335V6.98H.061Zm4.002 1.333H1.394v12.004h2.668V8.312Z"/></g><defs><clipPath id="a"><path fill="#fff" d="M.06.31H21.4v21.34H.06z"/></clipPath></defs></svg>
            </li>
          </ul>
        </SummarySection>
      </aside>
      <main class="work-history">
        <h3>Experience</h3>
        <div class="roles">
          {renderedRoles.map(({ data, Content }) => (
            <Role {...data}>
              <Content />
            </Role>
          ))}
        </div>
      </main>
    </div>

    <div class="icon-bar">
      <a class="icon" href="/">
        <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 32 32"><path fill="#000" d="m14 26 1.41-1.41L7.83 17H28v-2H7.83l7.58-7.59L14 6 4 16l10 10Z"/></svg>
      </a>
      <button class="icon" onclick="window.print()">
        <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 32 32"><path fill="#000" d="M28 9h-3V3H7v6H4a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h3v6h18v-6h3a2 2 0 0 0 2-2V11a2 2 0 0 0-2-2ZM9 5h14v4H9V5Zm14 22H9V17h14v10Zm5-6h-3v-6H7v6H4V11h24v10Z"/></svgaria-hidden="true">
      </button>
    </div>
  </div>
</Layout>

<style lang="scss" is:global>
  .cv-page {
    display: grid;
    align-content: center;
    justify-items: center;
    gap: var(--size-7);
    padding-block: var(--size-8);
    min-height: 100dvh;

    .cv {
      display: grid;
      grid-template-columns: 260px 1fr;
      grid-template-rows: repeat(auto-fit, minmax(0px, 1fr));
      width: 210mm;
      height: 297mm;
      box-shadow: 0 0 200px -50px hsl(0deg 0% 100% / 15%);

      a {
        text-decoration: underline;
        padding-right: 0.85em;
        color: inherit;

        &::after {
          content: 'â†—';
          position: absolute;
          margin-left: 0.2em;
          font-weight: var(--font-weight-5);
        }
      }

      h1 {
        font-size: 35.6px;
      }

      h2 {
        font-size: var(--font-size-1);
        font-weight: var(--font-weight-4);
        text-transform: uppercase;
        letter-spacing: 11.2px;
        margin-right: -11.2px;
      }

      h3 {
        font-size: var(--font-size-2);
        font-weight: var(--font-weight-8);
        text-transform: uppercase;
        letter-spacing: var(--font-letterspacing-4);
      }

      h4 {
        font-size: 14px;
        font-weight: var(--font-weight-7);
      }
    }
  }

  .summary-bar {
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    justify-content: space-between;
    padding: var(--size-4);
    background-color: black;

    .me {
      opacity: 0.01;
      font-size: var(--font-size-0);
      text-wrap: nowrap;
      margin-top: -15px;
    }

    .logo {
      width: 100%;
      margin-bottom: var(--size-3);
      margin-top: var(--size-1);
    }

    .inner-summary {
      text-align: end;

      a {
        color: inherit;
      }

      &.-education {
        > * {
        line-height: var(--font-lineheight-4);
        }

        p {
          font-size: 10px;
          font-weight: var(--font-weight-5);
          letter-spacing: var(--font-letterspacing-2);
          text-transform: uppercase;
          color: var(--gray-6);
        }

        .note {
          font-size: var(--font-size-0);
          font-weight: var(--font-weight-4);
          letter-spacing: unset;
          text-transform: unset;
        }
      }

      &.-personal {
        display: flex;
        flex-direction: column;
        gap: var(--size-3);
        list-style: none;
        font-size: var(--font-size-0);
        font-weight: var(--font-weight-6);

        li {
          display: flex;
          gap: var(--size-2);
          justify-content: flex-end;
          align-items: center;

          .icon {
            width: 24px;
            flex: 0 0 auto;
          }
        }
      }
    }
  }

  .work-history {
    display: flex;
    flex-direction: column;
    background-color: white;
    padding: var(--size-4);
    color: var(--gray-9);

    h3 {
      margin-bottom: var(--size-3);
    }

    .roles {
      flex: 1;
      display: flex;
      justify-content: space-between;
      flex-direction: column;
      gap: 12px;
    }
  }

  .icon-bar {
      display: flex;
      border-radius: var(--radius-round);
      background-color: white;
      width: fit-content;
      box-shadow: 0 0 50px -16px hsl(0deg 0% 100% / 50%);

      .icon {
        box-sizing: content-box;
        padding: var(--size-3);
        border-radius: var(--radius-round);
        width: 32px;
        background-color: unset;
        box-shadow: 0 0 48px -12px transparent;
        scale: 0.925;
        transition: box-shadow 400ms cubic-bezier(0.8, 0.6, 0, 1), scale 200ms ease-in;

        &:hover {
          box-shadow: 0 0 72px -12px white;
          scale: 1;
        }
      }
    }

@media print {
  html {
    background-color: unset;

    > *:not(body, head) {
      display: none !important;
    }
  }

  body {
    > *:not(.cv-page) {
      display: none !important;
    }
  }

  .cv-page {
    > *:not(.cv) {
      display: none !important;
    }
  }

  .cv-page {
    padding: 0;
    -webkit-print-color-adjust: exact;
    color-adjust: exact;
    print-color-adjust: exact;
  }
}
</style>
